{"ast":null,"code":"import _toConsumableArray from\"/Users/ryan.gillies/Documents/side_judge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/toConsumableArray\";import _regeneratorRuntime from\"/Users/ryan.gillies/Documents/side_judge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Users/ryan.gillies/Documents/side_judge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/Users/ryan.gillies/Documents/side_judge/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect}from'react';import{useLocation,useHistory}from'react-router-dom';import PageTitle from'../components/Typography/PageTitle';import{Table,TableHeader,TableCell,TableBody,TableRow,TableFooter,TableContainer,Select,Label,Pagination}from'@windmill/react-ui';import{Icon}from'@iconify/react';import arrowDown from'@iconify/icons-heroicons-solid/arrow-down';import{Bar}from'react-chartjs-2';import ChartCard from'../components/Chart/ChartCard';function PayoutDetails(){var location=useLocation();var searchParams=new URLSearchParams(location.search);var _useState=useState([]),_useState2=_slicedToArray(_useState,2),seasons=_useState2[0],setSeasons=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),users=_useState4[0],setUsers=_useState4[1];var _useState5=useState(searchParams.get('season')),_useState6=_slicedToArray(_useState5,2),selectedSeason=_useState6[0],setSelectedSeason=_useState6[1];var _useState7=useState(searchParams.get('username')),_useState8=_slicedToArray(_useState7,2),selectedUser=_useState8[0],setSelectedUser=_useState8[1];var _useState9=useState(1),_useState10=_slicedToArray(_useState9,2),pageTable=_useState10[0],setPageTable=_useState10[1];var _useState11=useState([]),_useState12=_slicedToArray(_useState11,2),dataTable=_useState12[0],setDataTable=_useState12[1];var _useState13=useState([]),_useState14=_slicedToArray(_useState13,2),chartData=_useState14[0],setChartData=_useState14[1];var _useState15=useState('amount'),_useState16=_slicedToArray(_useState15,2),sortBy=_useState16[0],setSortBy=_useState16[1];var _useState17=useState('desc'),_useState18=_slicedToArray(_useState17,2),sortDirection=_useState18[0],setSortDirection=_useState18[1];var _useState19=useState(0),_useState20=_slicedToArray(_useState19,2),totalResults=_useState20[0],setTotalResults=_useState20[1];var resultsPerPage=10;function onPageChangeTable(p){setPageTable(p);}useEffect(function(){function fetchSeasons(){return _fetchSeasons.apply(this,arguments);}function _fetchSeasons(){_fetchSeasons=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var response,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.prev=0;_context.next=3;return fetch(\"/api/v1/leagues/seasons\");case 3:response=_context.sent;if(response.ok){_context.next=6;break;}throw new Error('Network response was not ok');case 6:_context.next=8;return response.json();case 8:data=_context.sent;setSeasons(data);_context.next=15;break;case 12:_context.prev=12;_context.t0=_context[\"catch\"](0);console.error('Error fetching seasons:',_context.t0);case 15:case\"end\":return _context.stop();}}},_callee,null,[[0,12]]);}));return _fetchSeasons.apply(this,arguments);}fetchSeasons();},[]);useEffect(function(){function fetchUsers(){return _fetchUsers.apply(this,arguments);}function _fetchUsers(){_fetchUsers=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var response,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.prev=0;_context2.next=3;return fetch(\"/api/v1/users\");case 3:response=_context2.sent;if(response.ok){_context2.next=6;break;}throw new Error('Network response was not ok');case 6:_context2.next=8;return response.json();case 8:data=_context2.sent;setUsers(data);_context2.next=15;break;case 12:_context2.prev=12;_context2.t0=_context2[\"catch\"](0);console.error('Error fetching seasons:',_context2.t0);case 15:case\"end\":return _context2.stop();}}},_callee2,null,[[0,12]]);}));return _fetchUsers.apply(this,arguments);}fetchUsers();},[]);useEffect(function(){function fetchPayouts(){return _fetchPayouts.apply(this,arguments);}function _fetchPayouts(){_fetchPayouts=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){var url,response,data,usernames,poolTypes,poolTypeColors,userPayouts,datasets,_chartData;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_context3.prev=0;url='/api/v1/payouts/';if(selectedSeason){url=\"/api/v1/payouts/\".concat(selectedSeason);}_context3.next=5;return fetch(url);case 5:response=_context3.sent;if(response.ok){_context3.next=8;break;}throw new Error('Network response was not ok');case 8:_context3.next=10;return response.json();case 10:data=_context3.sent;usernames=_toConsumableArray(new Set(data.map(function(payout){return payout.name;})));poolTypes=_toConsumableArray(new Set(data.map(function(payout){return payout.pool_type;})));poolTypeColors={'main':'#7e3af2','side':'#0694a2'};// Initialize an empty object to hold aggregated payouts for each user\nuserPayouts={};// Loop through each user and pool type to aggregate payouts\nusernames.forEach(function(name){// Initialize an empty array to hofld payouts for the current user\nuserPayouts[name]=[];// Loop through each pool type to aggregate payouts for the current user\npoolTypes.sort();poolTypes.forEach(function(poolType){// Filter payouts for the current user and pool type\nvar payoutsForUserAndType=data.filter(function(payout){return payout.name===name&&payout.pool_type===poolType;});// Sum up the payouts for the current user and pool type\nvar totalPayoutForUserAndType=payoutsForUserAndType.reduce(function(sum,payout){return sum+payout.amount;},0);// Push the total payout for the current user and pool type to the array\nuserPayouts[name].push(totalPayoutForUserAndType);});});// Sort the usernames based on total payout amount\nusernames.sort(function(a,b){var totalPayoutA=userPayouts[a].reduce(function(sum,amount){return sum+amount;},0);var totalPayoutB=userPayouts[b].reduce(function(sum,amount){return sum+amount;},0);return totalPayoutB-totalPayoutA;});// Create datasets for each pool type\ndatasets=poolTypes.map(function(type){return{label:type,data:usernames.map(function(username){return userPayouts[username][poolTypes.indexOf(type)];}),backgroundColor:poolTypeColors[type],stack:'stack'};});_chartData={labels:usernames,datasets:datasets};setChartData(_chartData);_context3.next=25;break;case 22:_context3.prev=22;_context3.t0=_context3[\"catch\"](0);console.error('Error fetching payouts:',_context3.t0);case 25:case\"end\":return _context3.stop();}}},_callee3,null,[[0,22]]);}));return _fetchPayouts.apply(this,arguments);}fetchPayouts().catch(console.error);// Log any errors thrown\n},[selectedSeason]);var chartOptions={responsive:true,maintainAspectRatio:false,tooltips:{callbacks:{label:function label(tooltipItem,data){var value=data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];// Format the value as currency with $#,###.##\nreturn value.toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0});}}},scales:{xAxes:[{stacked:true}],yAxes:[{ticks:{beginAtZero:true,userCallback:function userCallback(value,index,values){return value.toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:0,maximumFractionDigits:0});}}}]}};var handleBarClick=function handleBarClick(event,chartElements){if(chartElements.length>0){var clickedIndex=chartElements[0].index;var clickedUsername=chartData.labels[clickedIndex];setSelectedUser(clickedUsername);// Update selectedUser state\n}};// Function to handle dropdown change event\nvar handleUserDropdownChange=function handleUserDropdownChange(e){setSelectedUser(e.target.value);// Update selectedUser state\n};useEffect(function(){function fetchPayoutDetails(){return _fetchPayoutDetails.apply(this,arguments);}function _fetchPayoutDetails(){_fetchPayoutDetails=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var url,response,data;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.prev=0;url='/api/v1/payoutdetails';if(selectedSeason&&selectedUser){url+=\"?season=\".concat(selectedSeason,\"&username=\").concat(selectedUser);}else if(selectedSeason){url+=\"?season=\".concat(selectedSeason);}else if(selectedUser){url+=\"?username=\".concat(selectedUser);}_context4.next=5;return fetch(url);case 5:response=_context4.sent;if(response.ok){_context4.next=8;break;}throw new Error('Network response was not ok');case 8:_context4.next=10;return response.json();case 10:data=_context4.sent;setDataTable(data);setTotalResults(data.length);setPageTable(1);_context4.next=19;break;case 16:_context4.prev=16;_context4.t0=_context4[\"catch\"](0);console.error('Error fetching payouts:',_context4.t0);case 19:case\"end\":return _context4.stop();}}},_callee4,null,[[0,16]]);}));return _fetchPayoutDetails.apply(this,arguments);}fetchPayoutDetails();},[selectedSeason,selectedUser]);var sortedData=_toConsumableArray(dataTable);if(sortBy){sortedData.sort(function(a,b){var valA=a[sortBy];var valB=b[sortBy];if(valA<valB)return sortDirection==='asc'?-1:1;if(valA>valB)return sortDirection==='asc'?1:-1;return 0;});}var startIndex=(pageTable-1)*resultsPerPage;var endIndex=Math.min(startIndex+resultsPerPage,totalResults);var paginatedData=sortedData.slice(startIndex,endIndex);function formatAmount(amount){// Format the amount as currency with $#,###.##\nreturn amount.toLocaleString('en-US',{style:'currency',currency:'USD',minimumFractionDigits:2,maximumFractionDigits:2});}return/*#__PURE__*/React.createElement(React.Fragment,null,/*#__PURE__*/React.createElement(PageTitle,null,\"Payouts\"),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'20px'}},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(\"strong\",null,\"Season\"),/*#__PURE__*/React.createElement(Select,{className:\"mb-4\",value:selectedSeason,onChange:function onChange(e){return setSelectedSeason(e.target.value);}},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"All-Time\"),seasons.map(function(season){return/*#__PURE__*/React.createElement(\"option\",{key:season,value:season},season);})))),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'20px'}},/*#__PURE__*/React.createElement(ChartCard,{title:\"Payouts\"},/*#__PURE__*/React.createElement(Bar,{data:chartData,options:chartOptions,getElementAtEvent:function getElementAtEvent(event,chartElements){return handleBarClick(event,chartElements);}}))),/*#__PURE__*/React.createElement(\"div\",{style:{marginBottom:'20px'}},/*#__PURE__*/React.createElement(Label,null,/*#__PURE__*/React.createElement(\"strong\",null,\"User\"),/*#__PURE__*/React.createElement(Select,{className:\"mb-4\",value:selectedUser,onChange:handleUserDropdownChange// Call handleUserDropdownChange on change\n},/*#__PURE__*/React.createElement(\"option\",{value:\"\"},\"All Users\"),users.map(function(user){return/*#__PURE__*/React.createElement(\"option\",{key:user.username,value:user.username},user.name);})))),/*#__PURE__*/React.createElement(TableContainer,{className:\"mb-8\"},/*#__PURE__*/React.createElement(Table,null,/*#__PURE__*/React.createElement(TableHeader,null,/*#__PURE__*/React.createElement(\"tr\",null,/*#__PURE__*/React.createElement(TableCell,{className:\"cursor-pointer\",onClick:function onClick(){setSortBy('username');setSortDirection(sortDirection==='asc'?'desc':'asc');}},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center\"},\"User\",sortBy==='username'&&/*#__PURE__*/React.createElement(Icon,{className:\"ml-1 transform \".concat(sortDirection==='asc'?'rotate-180':''),icon:arrowDown}))),/*#__PURE__*/React.createElement(TableCell,{className:\"cursor-pointer\",onClick:function onClick(){setSortBy('pool');setSortDirection(sortDirection==='asc'?'desc':'asc');}},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center\"},\"Pool\",sortBy==='pool'&&/*#__PURE__*/React.createElement(Icon,{className:\"ml-1 transform \".concat(sortDirection==='asc'?'rotate-180':''),icon:arrowDown}))),/*#__PURE__*/React.createElement(TableCell,{className:\"cursor-pointer\",onClick:function onClick(){setSortBy('season');setSortDirection(sortDirection==='asc'?'desc':'asc');}},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center\"},\"Season\",sortBy==='season'&&/*#__PURE__*/React.createElement(Icon,{className:\"ml-1 transform \".concat(sortDirection==='asc'?'rotate-180':''),icon:arrowDown}))),/*#__PURE__*/React.createElement(TableCell,{className:\"cursor-pointer\",onClick:function onClick(){setSortBy('week');setSortDirection(sortDirection==='asc'?'desc':'asc');}},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center\"},\"Week\",sortBy==='week'&&/*#__PURE__*/React.createElement(Icon,{className:\"ml-1 transform \".concat(sortDirection==='asc'?'rotate-180':''),icon:arrowDown}))),/*#__PURE__*/React.createElement(TableCell,{className:\"cursor-pointer\",onClick:function onClick(){setSortBy('amount');setSortDirection(sortDirection==='asc'?'desc':'asc');}},/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center\"},\"Amount\",sortBy==='amount'&&/*#__PURE__*/React.createElement(Icon,{className:\"ml-1 transform \".concat(sortDirection==='asc'?'rotate-180':''),icon:arrowDown}))))),/*#__PURE__*/React.createElement(TableBody,null,paginatedData.map(function(payout,i){return/*#__PURE__*/React.createElement(TableRow,{key:i},/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center text-sm\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-medium\"},payout.name)))),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center text-sm\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-medium\"},payout.pool)))),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center text-sm\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-medium\"},payout.season)))),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center text-sm\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-medium\"},payout.week)))),/*#__PURE__*/React.createElement(TableCell,null,/*#__PURE__*/React.createElement(\"div\",{className:\"flex items-center text-sm\"},/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"p\",{className:\"font-medium\"},formatAmount(payout.amount))))));}))),/*#__PURE__*/React.createElement(TableFooter,null,totalResults>resultsPerPage&&/*#__PURE__*/React.createElement(Pagination,{totalResults:totalResults,resultsPerPage:resultsPerPage,onChange:onPageChangeTable,currentPage:pageTable,label:\"Table navigation\"}))));}export default PayoutDetails;","map":{"version":3,"sources":["/Users/ryan.gillies/Documents/side_judge/src/pages/Payouts.js"],"names":["React","useState","useEffect","useLocation","useHistory","PageTitle","Table","TableHeader","TableCell","TableBody","TableRow","TableFooter","TableContainer","Select","Label","Pagination","Icon","arrowDown","Bar","ChartCard","PayoutDetails","location","searchParams","URLSearchParams","search","seasons","setSeasons","users","setUsers","get","selectedSeason","setSelectedSeason","selectedUser","setSelectedUser","pageTable","setPageTable","dataTable","setDataTable","chartData","setChartData","sortBy","setSortBy","sortDirection","setSortDirection","totalResults","setTotalResults","resultsPerPage","onPageChangeTable","p","fetchSeasons","fetch","response","ok","Error","json","data","console","error","fetchUsers","fetchPayouts","url","usernames","Set","map","payout","name","poolTypes","pool_type","poolTypeColors","userPayouts","forEach","sort","poolType","payoutsForUserAndType","filter","totalPayoutForUserAndType","reduce","sum","amount","push","a","b","totalPayoutA","totalPayoutB","datasets","type","label","username","indexOf","backgroundColor","stack","labels","catch","chartOptions","responsive","maintainAspectRatio","tooltips","callbacks","tooltipItem","value","datasetIndex","index","toLocaleString","style","currency","minimumFractionDigits","maximumFractionDigits","scales","xAxes","stacked","yAxes","ticks","beginAtZero","userCallback","values","handleBarClick","event","chartElements","length","clickedIndex","clickedUsername","handleUserDropdownChange","e","target","fetchPayoutDetails","sortedData","valA","valB","startIndex","endIndex","Math","min","paginatedData","slice","formatAmount","marginBottom","season","user","i","pool","week"],"mappings":"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","sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useLocation, useHistory } from 'react-router-dom';\nimport PageTitle from '../components/Typography/PageTitle';\nimport {\n  Table,\n  TableHeader,\n  TableCell,\n  TableBody,\n  TableRow,\n  TableFooter,\n  TableContainer,\n  Select,\n  Label,\n  Pagination,\n} from '@windmill/react-ui';\nimport { Icon } from '@iconify/react';\nimport arrowDown from '@iconify/icons-heroicons-solid/arrow-down';\nimport { Bar } from 'react-chartjs-2';\nimport ChartCard from '../components/Chart/ChartCard'\n\nfunction PayoutDetails() {\n  const location = useLocation();\n  const searchParams = new URLSearchParams(location.search);\n  const [seasons, setSeasons] = useState([]);\n  const [users, setUsers] = useState([]);\n  const [selectedSeason, setSelectedSeason] = useState(searchParams.get('season'));\n  const [selectedUser, setSelectedUser] = useState(searchParams.get('username'));\n\n  const [pageTable, setPageTable] = useState(1);\n  const [dataTable, setDataTable] = useState([]);\n  const [chartData, setChartData] = useState([]);\n  const [sortBy, setSortBy] = useState('amount');\n  const [sortDirection, setSortDirection] = useState('desc');\n  const [totalResults, setTotalResults] = useState(0);\n  const resultsPerPage = 10;\n\n  function onPageChangeTable(p) {\n    setPageTable(p);\n  }\n\n  useEffect(() => {\n    async function fetchSeasons() {\n      try {\n        const response = await fetch(`/api/v1/leagues/seasons`);\n        if (!response.ok) {\n          throw new Error('Network response was not ok');\n        }\n        const data = await response.json();\n        setSeasons(data);\n      } catch (error) {\n        console.error('Error fetching seasons:', error);\n      }\n    }\n\n    fetchSeasons();\n  }, []);\n\n  useEffect(() => {\n    async function fetchUsers() {\n      try {\n        const response = await fetch(`/api/v1/users`);\n        if (!response.ok) {\n          throw new Error('Network response was not ok');\n        }\n        const data = await response.json();\n        setUsers(data);\n      } catch (error) {\n        console.error('Error fetching seasons:', error);\n      }\n    }\n\n    fetchUsers();\n  }, []);\n\n\n  useEffect(() => {\n    async function fetchPayouts() {\n      try {\n        let url = '/api/v1/payouts/';\n        if (selectedSeason) {\n          url = `/api/v1/payouts/${selectedSeason}`;\n        }\n\n        const response = await fetch(url);\n\n        if (!response.ok) {\n          throw new Error('Network response was not ok');\n        }\n\n        const data = await response.json();\n\n        const usernames = [...new Set(data.map((payout) => payout.name))];\n        const poolTypes = [...new Set(data.map((payout) => payout.pool_type))];\n        const poolTypeColors = {\n          'main': '#7e3af2',\n          'side': '#0694a2',\n        };\n\n        // Initialize an empty object to hold aggregated payouts for each user\n        const userPayouts = {};\n\n        // Loop through each user and pool type to aggregate payouts\n        usernames.forEach(name => {\n          // Initialize an empty array to hofld payouts for the current user\n          userPayouts[name] = [];\n\n          // Loop through each pool type to aggregate payouts for the current user\n          poolTypes.sort();\n          poolTypes.forEach(poolType => {\n            // Filter payouts for the current user and pool type\n            const payoutsForUserAndType = data.filter(payout => payout.name === name && payout.pool_type === poolType);\n            // Sum up the payouts for the current user and pool type\n            const totalPayoutForUserAndType = payoutsForUserAndType.reduce((sum, payout) => sum + payout.amount, 0);\n            // Push the total payout for the current user and pool type to the array\n            userPayouts[name].push(totalPayoutForUserAndType);\n          });\n        });\n\n        // Sort the usernames based on total payout amount\n        usernames.sort((a, b) => {\n          const totalPayoutA = userPayouts[a].reduce((sum, amount) => sum + amount, 0);\n          const totalPayoutB = userPayouts[b].reduce((sum, amount) => sum + amount, 0);\n          return totalPayoutB - totalPayoutA;\n        });\n\n        // Create datasets for each pool type\n        const datasets = poolTypes.map((type) => {\n          return {\n            label: type,\n            data: usernames.map((username) => userPayouts[username][poolTypes.indexOf(type)]),\n            backgroundColor: poolTypeColors[type],\n            stack: 'stack',\n          };\n        });\n\n        const chartData = {\n          labels: usernames,\n          datasets,\n        };\n\n        setChartData(chartData);\n      } catch (error) {\n        console.error('Error fetching payouts:', error);\n      }\n    }\n    fetchPayouts().catch(console.error); // Log any errors thrown\n  }, [selectedSeason]);\n\n  const chartOptions = {\n    responsive: true,\n    maintainAspectRatio: false,\n    tooltips: {\n      callbacks: {\n        label: function (tooltipItem, data) {\n          let value = data.datasets[tooltipItem.datasetIndex].data[tooltipItem.index];\n          // Format the value as currency with $#,###.##\n          return value.toLocaleString('en-US', {\n            style: 'currency',\n            currency: 'USD',\n            minimumFractionDigits: 0,\n            maximumFractionDigits: 0\n          });\n        }\n      }\n    },\n    scales: {\n      xAxes: [\n        {\n          stacked: true,\n        }\n      ],\n      yAxes: [\n        {\n          ticks: {\n            beginAtZero: true,\n            userCallback: function (value, index, values) {\n              return value.toLocaleString('en-US', { style: 'currency', currency: 'USD', minimumFractionDigits: 0, maximumFractionDigits: 0 });\n            }\n          }\n        }\n      ],\n    },\n  };\n\n  const handleBarClick = (event, chartElements) => {\n    if (chartElements.length > 0) {\n      const clickedIndex = chartElements[0].index;\n      const clickedUsername = chartData.labels[clickedIndex];\n      setSelectedUser(clickedUsername); // Update selectedUser state\n    }\n  };\n\n  // Function to handle dropdown change event\n  const handleUserDropdownChange = (e) => {\n    setSelectedUser(e.target.value); // Update selectedUser state\n  };\n\n  useEffect(() => {\n    async function fetchPayoutDetails() {\n      try {\n        let url = '/api/v1/payoutdetails';\n\n        if (selectedSeason && selectedUser) {\n          url += `?season=${selectedSeason}&username=${selectedUser}`;\n        } else if (selectedSeason) {\n          url += `?season=${selectedSeason}`;\n        } else if (selectedUser) {\n          url += `?username=${selectedUser}`;\n        }\n\n        const response = await fetch(url);\n\n        if (!response.ok) {\n          throw new Error('Network response was not ok');\n        }\n\n        const data = await response.json();\n        setDataTable(data);\n        setTotalResults(data.length);\n        setPageTable(1);\n      } catch (error) {\n        console.error('Error fetching payouts:', error);\n      }\n    }\n\n    fetchPayoutDetails();\n  }, [selectedSeason, selectedUser]);\n\n\n\n  const sortedData = [...dataTable];\n  if (sortBy) {\n    sortedData.sort((a, b) => {\n      const valA = a[sortBy];\n      const valB = b[sortBy];\n      if (valA < valB) return sortDirection === 'asc' ? -1 : 1;\n      if (valA > valB) return sortDirection === 'asc' ? 1 : -1;\n      return 0;\n    });\n  }\n\n  const startIndex = (pageTable - 1) * resultsPerPage;\n  const endIndex = Math.min(startIndex + resultsPerPage, totalResults);\n  const paginatedData = sortedData.slice(startIndex, endIndex);\n\n  function formatAmount(amount) {\n    // Format the amount as currency with $#,###.##\n    return amount.toLocaleString('en-US', {\n      style: 'currency',\n      currency: 'USD',\n      minimumFractionDigits: 2,\n      maximumFractionDigits: 2\n    });\n  }\n\n  return (\n    <>\n      <PageTitle>Payouts</PageTitle>\n\n      {/* Dropdown to select season */}\n      <div style={{ marginBottom: '20px' }}>\n        <Label>\n          <strong>Season</strong>\n          <Select\n            className=\"mb-4\"\n            value={selectedSeason}\n            onChange={(e) => setSelectedSeason(e.target.value)}\n          >\n            <option value=\"\">All-Time</option>\n            {seasons.map((season) => (\n              <option key={season} value={season}>\n                {season}\n              </option>\n            ))}\n          </Select>\n        </Label>\n      </div>\n\n      <div style={{ marginBottom: '20px' }}>\n        <ChartCard title=\"Payouts\">\n          <Bar data={chartData}\n            options={chartOptions}\n            getElementAtEvent={(event, chartElements) => handleBarClick(event, chartElements)}\n          />\n        </ChartCard>\n      </div>\n      {/* Dropdown to select user */}\n      <div style={{ marginBottom: '20px' }}>\n        <Label>\n          <strong>User</strong>\n          <Select\n            className=\"mb-4\"\n            value={selectedUser}\n            onChange={handleUserDropdownChange} // Call handleUserDropdownChange on change\n          >\n            <option value=\"\">All Users</option>\n            {users.map((user) => (\n              <option key={user.username} value={user.username}>\n                {user.name}\n              </option>\n            ))}\n          </Select>\n        </Label>\n      </div>\n\n\n      <TableContainer className=\"mb-8\">\n        <Table>\n          <TableHeader>\n            <tr>\n              <TableCell\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  setSortBy('username');\n                  setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n                }}\n              >\n                <div className=\"flex items-center\">\n                  User\n                  {sortBy === 'username' && (\n                    <Icon\n                      className={`ml-1 transform ${sortDirection === 'asc' ? 'rotate-180' : ''}`}\n                      icon={arrowDown}\n                    />\n                  )}\n                </div>\n              </TableCell>\n              <TableCell\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  setSortBy('pool');\n                  setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n                }}\n              >\n                <div className=\"flex items-center\">\n                  Pool\n                  {sortBy === 'pool' && (\n                    <Icon\n                      className={`ml-1 transform ${sortDirection === 'asc' ? 'rotate-180' : ''}`}\n                      icon={arrowDown}\n                    />\n                  )}\n                </div>\n              </TableCell>\n              <TableCell\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  setSortBy('season');\n                  setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n                }}\n              >\n                <div className=\"flex items-center\">\n                  Season\n                  {sortBy === 'season' && (\n                    <Icon\n                      className={`ml-1 transform ${sortDirection === 'asc' ? 'rotate-180' : ''}`}\n                      icon={arrowDown}\n                    />\n                  )}\n                </div>\n              </TableCell>\n              <TableCell\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  setSortBy('week');\n                  setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n                }}\n              >\n                <div className=\"flex items-center\">\n                  Week\n                  {sortBy === 'week' && (\n                    <Icon\n                      className={`ml-1 transform ${sortDirection === 'asc' ? 'rotate-180' : ''}`}\n                      icon={arrowDown}\n                    />\n                  )}\n                </div>\n              </TableCell>\n              <TableCell\n                className=\"cursor-pointer\"\n                onClick={() => {\n                  setSortBy('amount');\n                  setSortDirection(sortDirection === 'asc' ? 'desc' : 'asc');\n                }}\n              >\n                <div className=\"flex items-center\">\n                  Amount\n                  {sortBy === 'amount' && (\n                    <Icon\n                      className={`ml-1 transform ${sortDirection === 'asc' ? 'rotate-180' : ''}`}\n                      icon={arrowDown}\n                    />\n                  )}\n                </div>\n              </TableCell>\n            </tr>\n          </TableHeader>\n          <TableBody>\n            {paginatedData.map((payout, i) => (\n              <TableRow key={i}>\n                <TableCell>\n                  <div className=\"flex items-center text-sm\">\n                    <div>\n                      <p className=\"font-medium\">{payout.name}</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell>\n                  <div className=\"flex items-center text-sm\">\n                    <div>\n                      <p className=\"font-medium\">{payout.pool}</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell>\n                  <div className=\"flex items-center text-sm\">\n                    <div>\n                      <p className=\"font-medium\">{payout.season}</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell>\n                  <div className=\"flex items-center text-sm\">\n                    <div>\n                      <p className=\"font-medium\">{payout.week}</p>\n                    </div>\n                  </div>\n                </TableCell>\n                <TableCell>\n                  <div className=\"flex items-center text-sm\">\n                    <div>\n                      <p className=\"font-medium\">{formatAmount(payout.amount)}</p>\n                    </div>\n                  </div>\n                </TableCell>\n              </TableRow>\n            ))}\n          </TableBody>\n        </Table>\n        {/* Pagination component */}\n        <TableFooter>\n          {totalResults > resultsPerPage && (\n            <Pagination\n              totalResults={totalResults}\n              resultsPerPage={resultsPerPage}\n              onChange={onPageChangeTable}\n              currentPage={pageTable}\n              label=\"Table navigation\"\n            />\n          )}\n        </TableFooter>\n\n      </TableContainer>\n    </>\n  );\n}\n\nexport default PayoutDetails;\n"]},"metadata":{},"sourceType":"module"}